============================= test session starts ==============================
platform darwin -- Python 3.11.12, pytest-8.3.5, pluggy-1.6.0
rootdir: /Users/selman.ozleyen/Documents/projects/cell_flow_perturbation
configfile: pyproject.toml
plugins: jaxtyping-0.3.2, fast-array-utils-1.2.1, mock-3.14.0, cov-6.1.1, xdist-3.6.1
collected 145 items / 144 deselected / 1 selected

tests/model/test_cellflow.py {'control': array([[ 0.59391007],
       [ 0.20409122],
       [ 2.01214352],
       [-0.44800279],
       [ 1.00077153]]), 'drug_a': array([[-0.93050865],
       [-0.38520746],
       [ 0.41066904],
       [ 0.99718101],
       [ 0.93126932]]), 'drug_b': array([[ 3.11366179],
       [-0.71490066],
       [-1.17020534],
       [-2.00621602],
       [ 0.03705156]]), 'drug_c': array([[-1.88794363],
       [-0.88174978],
       [ 1.65713978],
       [-0.64648739],
       [ 0.64351735]])}
[34mINFO    [0m  Function args: split_cov_combs: [1m[[0m[1m[[0m[1m][0m[1m][0m, adata: AnnData object with n_obs Ã— n_vars = [1;36m500[0m Ã— [1;36m50[0m     
             obs: [32m'cell_type'[0m, [32m'dosage'[0m, [32m'drug1'[0m, [32m'drug2'[0m, [32m'drug3'[0m, [32m'dosage_a'[0m, [32m'dosage_b'[0m, [32m'dosage_c'[0m,  
         [32m'drug_a'[0m, [32m'drug_b'[0m, [32m'drug_c'[0m, [32m'control'[0m                                                         
             uns: [32m'drug'[0m, [32m'cell_type'[0m                                                                    
             obsm: [32m'X_pca'[0m                                                                               
             layers: [32m'my_counts'[0m, covariate_data: [3;35mNone[0m, rep_dict: [3;35mNone[0m, condition_id_key: [3;35mNone[0m           
[34mINFO    [0m self._perturbation_covariates: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m[[0m[32m'drug1'[0m, [32m'drug2'[0m[1m][0m[1m)[0m[1m][0m[1m)[0m                      
[34mINFO    [0m self._sample_covariates: [1m[[0m[1m][0m                                                                     
[34mINFO    [0m self._split_covariates: [1m[[0m[1m][0m                                                                      
[34mINFO    [0m old tgt_idx: [1;36m0[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m2.0468065292154103[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m1[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m0.28279460652485056[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m2[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m-0.09212040732973514[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m3[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m0.28279460652485067[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m4[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.481217316165709[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m5[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m6[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-0.09212040732973548[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m7[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m8[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-2.231047343874881[0m                                                                              
[34mINFO    [0m >old return: split_covariates_mask: [1m[[0m[1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m
         [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m                                                                                     
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m                        
          [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m                        
           [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
           [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m                        
           [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m                        
          [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m [1;36m-1[0m  [1;36m0[0m[1m][0m, perturbation_covariates_mask: [1m[[0m [1;36m0[0m
         [1;36m-1[0m  [1;36m0[0m  [1;36m8[0m  [1;36m4[0m  [1;36m3[0m  [1;36m2[0m  [1;36m5[0m  [1;36m2[0m  [1;36m1[0m  [1;36m6[0m  [1;36m3[0m  [1;36m1[0m  [1;36m5[0m  [1;36m1[0m [1;36m-1[0m  [1;36m8[0m  [1;36m5[0m  [1;36m5[0m  [1;36m1[0m  [1;36m2[0m  [1;36m6[0m [1;36m-1[0m  [1;36m7[0m                            
           [1;36m8[0m  [1;36m5[0m  [1;36m0[0m  [1;36m5[0m  [1;36m7[0m  [1;36m3[0m  [1;36m4[0m  [1;36m8[0m  [1;36m4[0m  [1;36m3[0m  [1;36m5[0m  [1;36m8[0m  [1;36m0[0m  [1;36m8[0m  [1;36m1[0m  [1;36m7[0m [1;36m-1[0m  [1;36m6[0m  [1;36m2[0m  [1;36m0[0m  [1;36m7[0m  [1;36m1[0m [1;36m-1[0m  [1;36m5[0m                        
           [1;36m0[0m [1;36m-1[0m  [1;36m0[0m  [1;36m1[0m  [1;36m1[0m  [1;36m8[0m  [1;36m7[0m  [1;36m4[0m  [1;36m4[0m  [1;36m5[0m  [1;36m8[0m  [1;36m5[0m  [1;36m2[0m  [1;36m8[0m  [1;36m5[0m  [1;36m8[0m  [1;36m0[0m  [1;36m4[0m  [1;36m3[0m  [1;36m4[0m  [1;36m3[0m  [1;36m3[0m  [1;36m3[0m  [1;36m1[0m                        
           [1;36m0[0m  [1;36m6[0m  [1;36m8[0m  [1;36m6[0m  [1;36m6[0m  [1;36m4[0m  [1;36m3[0m  [1;36m3[0m  [1;36m1[0m  [1;36m4[0m [1;36m-1[0m  [1;36m6[0m  [1;36m4[0m  [1;36m3[0m  [1;36m3[0m  [1;36m8[0m [1;36m-1[0m  [1;36m8[0m  [1;36m7[0m  [1;36m3[0m  [1;36m0[0m  [1;36m5[0m  [1;36m0[0m  [1;36m5[0m                        
           [1;36m8[0m  [1;36m0[0m  [1;36m5[0m  [1;36m5[0m  [1;36m1[0m  [1;36m6[0m  [1;36m6[0m  [1;36m2[0m  [1;36m7[0m  [1;36m2[0m  [1;36m1[0m [1;36m-1[0m  [1;36m3[0m  [1;36m0[0m  [1;36m7[0m  [1;36m1[0m  [1;36m5[0m  [1;36m6[0m [1;36m-1[0m  [1;36m7[0m [1;36m-1[0m  [1;36m4[0m  [1;36m1[0m  [1;36m8[0m                        
           [1;36m4[0m  [1;36m6[0m  [1;36m8[0m  [1;36m6[0m  [1;36m1[0m  [1;36m4[0m  [1;36m5[0m  [1;36m3[0m  [1;36m0[0m  [1;36m8[0m  [1;36m0[0m  [1;36m6[0m [1;36m-1[0m  [1;36m3[0m  [1;36m8[0m  [1;36m0[0m  [1;36m5[0m  [1;36m4[0m  [1;36m4[0m  [1;36m5[0m  [1;36m2[0m  [1;36m3[0m  [1;36m4[0m  [1;36m1[0m                        
           [1;36m1[0m  [1;36m8[0m [1;36m-1[0m  [1;36m7[0m  [1;36m1[0m  [1;36m2[0m  [1;36m2[0m [1;36m-1[0m  [1;36m3[0m  [1;36m4[0m  [1;36m8[0m  [1;36m2[0m  [1;36m3[0m  [1;36m8[0m  [1;36m5[0m [1;36m-1[0m  [1;36m0[0m  [1;36m4[0m  [1;36m0[0m  [1;36m0[0m  [1;36m1[0m [1;36m-1[0m  [1;36m5[0m  [1;36m7[0m                        
           [1;36m6[0m  [1;36m2[0m  [1;36m2[0m  [1;36m6[0m [1;36m-1[0m  [1;36m7[0m  [1;36m4[0m  [1;36m3[0m  [1;36m4[0m  [1;36m6[0m  [1;36m4[0m  [1;36m0[0m  [1;36m3[0m  [1;36m7[0m  [1;36m5[0m  [1;36m6[0m  [1;36m4[0m  [1;36m6[0m  [1;36m0[0m  [1;36m2[0m  [1;36m6[0m  [1;36m2[0m  [1;36m4[0m  [1;36m4[0m                        
           [1;36m7[0m  [1;36m1[0m  [1;36m0[0m [1;36m-1[0m  [1;36m4[0m  [1;36m0[0m  [1;36m1[0m [1;36m-1[0m  [1;36m5[0m  [1;36m6[0m  [1;36m7[0m  [1;36m8[0m  [1;36m3[0m  [1;36m1[0m  [1;36m2[0m  [1;36m1[0m  [1;36m0[0m  [1;36m3[0m  [1;36m2[0m [1;36m-1[0m  [1;36m1[0m  [1;36m4[0m  [1;36m7[0m  [1;36m6[0m                        
           [1;36m8[0m  [1;36m2[0m  [1;36m8[0m  [1;36m1[0m  [1;36m8[0m [1;36m-1[0m  [1;36m0[0m  [1;36m6[0m  [1;36m8[0m  [1;36m0[0m  [1;36m7[0m  [1;36m5[0m  [1;36m7[0m  [1;36m8[0m  [1;36m2[0m  [1;36m0[0m  [1;36m1[0m  [1;36m6[0m  [1;36m3[0m  [1;36m2[0m  [1;36m3[0m  [1;36m6[0m  [1;36m5[0m  [1;36m1[0m                        
           [1;36m7[0m  [1;36m0[0m  [1;36m7[0m [1;36m-1[0m  [1;36m7[0m  [1;36m5[0m  [1;36m8[0m  [1;36m2[0m  [1;36m6[0m  [1;36m8[0m  [1;36m8[0m [1;36m-1[0m  [1;36m3[0m  [1;36m0[0m [1;36m-1[0m  [1;36m1[0m  [1;36m1[0m  [1;36m8[0m  [1;36m0[0m  [1;36m4[0m  [1;36m2[0m  [1;36m5[0m [1;36m-1[0m  [1;36m0[0m                        
          [1;36m-1[0m  [1;36m5[0m  [1;36m1[0m  [1;36m7[0m  [1;36m8[0m  [1;36m8[0m  [1;36m6[0m  [1;36m6[0m  [1;36m3[0m  [1;36m3[0m  [1;36m5[0m  [1;36m8[0m  [1;36m2[0m  [1;36m4[0m [1;36m-1[0m  [1;36m8[0m  [1;36m4[0m  [1;36m2[0m  [1;36m8[0m  [1;36m2[0m  [1;36m1[0m [1;36m-1[0m  [1;36m7[0m  [1;36m0[0m                        
           [1;36m8[0m  [1;36m2[0m  [1;36m7[0m  [1;36m0[0m  [1;36m5[0m  [1;36m4[0m  [1;36m6[0m  [1;36m7[0m  [1;36m2[0m  [1;36m1[0m  [1;36m7[0m  [1;36m8[0m [1;36m-1[0m  [1;36m1[0m  [1;36m1[0m  [1;36m1[0m  [1;36m5[0m  [1;36m4[0m  [1;36m0[0m  [1;36m7[0m [1;36m-1[0m  [1;36m6[0m  [1;36m5[0m  [1;36m4[0m                        
           [1;36m0[0m  [1;36m8[0m  [1;36m3[0m  [1;36m5[0m [1;36m-1[0m  [1;36m8[0m  [1;36m4[0m  [1;36m2[0m  [1;36m3[0m  [1;36m6[0m  [1;36m0[0m [1;36m-1[0m  [1;36m6[0m  [1;36m8[0m  [1;36m6[0m  [1;36m0[0m  [1;36m1[0m  [1;36m1[0m  [1;36m4[0m  [1;36m4[0m  [1;36m1[0m  [1;36m0[0m  [1;36m3[0m  [1;36m7[0m                        
           [1;36m3[0m  [1;36m0[0m  [1;36m0[0m  [1;36m6[0m  [1;36m4[0m  [1;36m7[0m  [1;36m2[0m [1;36m-1[0m  [1;36m1[0m  [1;36m0[0m  [1;36m3[0m  [1;36m5[0m  [1;36m0[0m  [1;36m8[0m  [1;36m7[0m  [1;36m6[0m  [1;36m8[0m  [1;36m3[0m  [1;36m7[0m  [1;36m0[0m  [1;36m0[0m  [1;36m3[0m  [1;36m3[0m  [1;36m1[0m                        
           [1;36m2[0m  [1;36m3[0m  [1;36m1[0m [1;36m-1[0m  [1;36m3[0m  [1;36m1[0m [1;36m-1[0m  [1;36m6[0m  [1;36m6[0m  [1;36m8[0m  [1;36m6[0m  [1;36m3[0m [1;36m-1[0m  [1;36m5[0m  [1;36m3[0m  [1;36m8[0m  [1;36m8[0m  [1;36m8[0m  [1;36m7[0m [1;36m-1[0m  [1;36m8[0m  [1;36m2[0m  [1;36m6[0m  [1;36m1[0m                        
          [1;36m-1[0m  [1;36m1[0m  [1;36m2[0m  [1;36m3[0m  [1;36m5[0m  [1;36m1[0m  [1;36m1[0m  [1;36m7[0m [1;36m-1[0m  [1;36m3[0m  [1;36m6[0m [1;36m-1[0m  [1;36m0[0m  [1;36m6[0m  [1;36m0[0m  [1;36m1[0m  [1;36m4[0m  [1;36m8[0m  [1;36m2[0m  [1;36m1[0m  [1;36m3[0m [1;36m-1[0m  [1;36m5[0m  [1;36m3[0m                        
           [1;36m4[0m  [1;36m0[0m  [1;36m4[0m  [1;36m8[0m  [1;36m8[0m  [1;36m5[0m  [1;36m4[0m  [1;36m3[0m  [1;36m6[0m  [1;36m4[0m  [1;36m6[0m  [1;36m4[0m  [1;36m3[0m  [1;36m4[0m  [1;36m5[0m  [1;36m5[0m  [1;36m1[0m  [1;36m0[0m  [1;36m5[0m  [1;36m6[0m [1;36m-1[0m  [1;36m4[0m  [1;36m6[0m  [1;36m8[0m                        
           [1;36m1[0m  [1;36m0[0m  [1;36m4[0m  [1;36m5[0m  [1;36m6[0m  [1;36m8[0m  [1;36m8[0m  [1;36m3[0m  [1;36m1[0m  [1;36m4[0m  [1;36m6[0m  [1;36m1[0m [1;36m-1[0m  [1;36m6[0m  [1;36m5[0m  [1;36m6[0m  [1;36m2[0m  [1;36m4[0m  [1;36m0[0m  [1;36m4[0m [1;36m-1[0m  [1;36m2[0m  [1;36m7[0m  [1;36m6[0m                        
          [1;36m-1[0m  [1;36m0[0m  [1;36m8[0m  [1;36m6[0m  [1;36m4[0m [1;36m-1[0m  [1;36m0[0m  [1;36m1[0m  [1;36m7[0m  [1;36m6[0m  [1;36m2[0m  [1;36m7[0m  [1;36m8[0m  [1;36m4[0m  [1;36m7[0m  [1;36m2[0m  [1;36m3[0m  [1;36m8[0m  [1;36m6[0m  [1;36m2[0m [1;36m-1[0m  [1;36m4[0m  [1;36m4[0m [1;36m-1[0m                        
           [1;36m7[0m  [1;36m7[0m  [1;36m8[0m  [1;36m0[0m  [1;36m2[0m  [1;36m7[0m  [1;36m5[0m  [1;36m3[0m  [1;36m4[0m  [1;36m8[0m [1;36m-1[0m  [1;36m4[0m  [1;36m2[0m  [1;36m8[0m  [1;36m6[0m  [1;36m3[0m  [1;36m6[0m  [1;36m2[0m  [1;36m3[0m [1;36m-1[0m[1m][0m                                   
[34mINFO    [0m >old return: split_idx_to_covariates: [1m{[0m[1;36m0[0m: [1m([0m[1m)[0m[1m}[0m, perturbation_idx_to_covariates: [1m{[0m[1;36m0[0m:              
         [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m1[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m2[0m:     
         [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m3[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m4[0m:     
         [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m5[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m6[0m:     
         [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m7[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m8[0m:     
         [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m[1m}[0m                                                      
[34mINFO    [0m >old return: perturbation_idx_to_id: [1m{[0m[1m}[0m, condition_data: [1m{[0m[32m'drug'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1m[[0m[1;36m-0.93050865[0m,         
         [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                                          
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m[1m][0m[1m)[0m[1m}[0m                                                                       
[34mINFO    [0m >old return: control_to_perturbation: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[1;36m0[0m, [1;36m1[0m, [1;36m2[0m, [1;36m3[0m, [1;36m4[0m, [1;36m5[0m, [1;36m6[0m, [1;36m7[0m, [1;36m8[0m[1m][0m[1m)[0m[1m}[0m                   
[34mINFO    [0m  Function args: split_cov_combs: [1m[[0m[1m[[0m[1m][0m[1m][0m, adata: [3;35mNone[0m, covariate_data:        cell_type  dosage    
         drug1    drug2  [33m...[0m drug_a drug_b drug_c control                                                
         [1;36m0[0m    cell_line_c  [1;36m1000.0[0m   drug_a   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m1[0m    cell_line_c  [1;36m1000.0[0m  control  control  [33m...[0m  [3;91mFalse[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m2[0m    cell_line_a   [1;36m100.0[0m   drug_a   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m3[0m    cell_line_a   [1;36m100.0[0m   drug_c   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m4[0m    cell_line_b    [1;36m10.0[0m   drug_b   drug_b  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         ..           [33m...[0m     [33m...[0m      [33m...[0m      [33m...[0m  [33m...[0m    [33m...[0m    [33m...[0m    [33m...[0m     [33m...[0m                    
         [1;36m495[0m  cell_line_c   [1;36m100.0[0m   drug_b   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m496[0m  cell_line_c   [1;36m100.0[0m   drug_c   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m497[0m  cell_line_b   [1;36m100.0[0m   drug_a   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m498[0m  cell_line_b    [1;36m10.0[0m   drug_b   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m499[0m  cell_line_b  [1;36m1000.0[0m  control  control  [33m...[0m  [3;91mFalse[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
                                                                                                         
         [1m[[0m[1;36m500[0m rows x [1;36m12[0m columns[1m][0m, rep_dict: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m{[0m[32m'control'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.59391007[0m[1m][0m,      
                [1m[[0m [1;36m0.20409122[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.01214352[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.44800279[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.00077153[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-0.93050865[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.38520746[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.41066904[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.99718101[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.93126932[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.11366179[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.71490066[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-1.17020534[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-2.00621602[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.03705156[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-1.88794363[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.88174978[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.65713978[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.64648739[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.64351735[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m, [1m([0m[32m'cell_type'[0m, [1m{[0m[32m'cell_line_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.40729188[0m[1m][0m,                   
                [1m[[0m [1;36m0.89390673[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.00872591[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.33946631[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.38939039[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.12149732[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.16068739[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.68393176[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.23121534[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m[1m][0m[1m)[0m, condition_id_key: [3;35mNone[0m                                              
[34mINFO    [0m self._perturbation_covariates: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m[[0m[32m'drug1'[0m, [32m'drug2'[0m[1m][0m[1m)[0m[1m][0m[1m)[0m                      
[34mINFO    [0m self._sample_covariates: [1m[[0m[1m][0m                                                                     
[34mINFO    [0m self._split_covariates: [1m[[0m[1m][0m                                                                      
[34mINFO    [0m old tgt_idx: [1;36m0[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'control'[0m, [32m'drug2'[0m: [32m'control'[0m[1m}[0m                              
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m0.59391007[0m [1;36m0.20409122[0m [1;36m2.01214352[0m[1m][0m, sum:                 
         [1;36m6.725827115706103[0m                                                                               
[34mINFO    [0m old tgt_idx: [1;36m1[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m2.0468065292154103[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m2[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m0.28279460652485056[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m3[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m-0.09212040732973514[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m4[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m0.28279460652485067[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m5[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.481217316165709[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m6[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m7[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-0.09212040732973548[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m8[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m9[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-2.231047343874881[0m                                                                              
[34mINFO    [0m >old return: split_covariates_mask: [3;35mNone[0m, perturbation_covariates_mask: [3;35mNone[0m                    
[34mINFO    [0m >old return: split_idx_to_covariates: [1m{[0m[1m}[0m, perturbation_idx_to_covariates: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'control'[0m, 
         [32m'control'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m1[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m2[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m,    
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m3[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m4[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m5[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m6[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m7[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m8[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m,     
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m9[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m[1m}[0m                         
[34mINFO    [0m >old return: perturbation_idx_to_id: [1m{[0m[1m}[0m, condition_data: [1m{[0m[32m'drug'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1m[[0m [1;36m0.59391007[0m,         
         [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                                           
                   [1;36m1.00077153[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m0.59391007[0m,  [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                    
                   [1;36m1.00077153[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m[1m][0m[1m)[0m[1m}[0m                                                                       
[34mINFO    [0m >old return: control_to_perturbation: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[1;36m0[0m, [1;36m1[0m, [1;36m2[0m, [1;36m3[0m, [1;36m4[0m, [1;36m5[0m, [1;36m6[0m, [1;36m7[0m, [1;36m8[0m, [1;36m9[0m[1m][0m[1m)[0m[1m}[0m                
pred_data: PredictionData(cell_data=array([[0.54962515, 0.18763018, 0.56914549, ..., 0.38548274, 0.11456399,
        0.13340325],
       [0.32887327, 0.84993855, 0.02231562, ..., 0.62997669, 0.00914254,
        0.69455044],
       [0.81826634, 0.76025063, 0.76612795, ..., 0.48867486, 0.3932288 ,
        0.44532861],
       ...,
       [0.28179957, 0.10919196, 0.97260579, ..., 0.11311244, 0.33657766,
        0.15924755],
       [0.0996858 , 0.04953436, 0.81091584, ..., 0.80573532, 0.53882898,
        0.46909426],
       [0.71618425, 0.9698739 , 0.13739646, ..., 0.51119001, 0.74209687,
        0.5381115 ]], shape=(500, 50)), split_covariates_mask=array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int32), split_idx_to_covariates={}, perturbation_idx_to_covariates={0: array(['control', 'control'], dtype=object), 1: array(['drug_a', 'drug_a'], dtype=object), 2: array(['drug_a', 'drug_b'], dtype=object), 3: array(['drug_a', 'drug_c'], dtype=object), 4: array(['drug_b', 'drug_a'], dtype=object), 5: array(['drug_b', 'drug_b'], dtype=object), 6: array(['drug_b', 'drug_c'], dtype=object), 7: array(['drug_c', 'drug_a'], dtype=object), 8: array(['drug_c', 'drug_b'], dtype=object), 9: array(['drug_c', 'drug_c'], dtype=object)}, perturbation_idx_to_id={}, condition_data={'drug': array([[[ 0.59391007,  0.20409122,  2.01214352, -0.44800279,
          1.00077153],
        [ 0.59391007,  0.20409122,  2.01214352, -0.44800279,
          1.00077153]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]]])}, control_to_perturbation={0: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])}, max_combination_length=2, null_value=0.0, data_manager=<cellflow.data._datamanager.DataManager object at 0x178bcd8d0>)
[34mINFO    [0m  Function args: split_cov_combs: [1m[[0m[1m[[0m[1m][0m[1m][0m, adata: [3;35mNone[0m, covariate_data:        cell_type  dosage    
         drug1    drug2  [33m...[0m drug_a drug_b drug_c control                                                
         [1;36m0[0m    cell_line_c  [1;36m1000.0[0m   drug_a   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m1[0m    cell_line_c  [1;36m1000.0[0m  control  control  [33m...[0m  [3;91mFalse[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m2[0m    cell_line_a   [1;36m100.0[0m   drug_a   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m3[0m    cell_line_a   [1;36m100.0[0m   drug_c   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m4[0m    cell_line_b    [1;36m10.0[0m   drug_b   drug_b  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         ..           [33m...[0m     [33m...[0m      [33m...[0m      [33m...[0m  [33m...[0m    [33m...[0m    [33m...[0m    [33m...[0m     [33m...[0m                    
         [1;36m495[0m  cell_line_c   [1;36m100.0[0m   drug_b   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m496[0m  cell_line_c   [1;36m100.0[0m   drug_c   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m497[0m  cell_line_b   [1;36m100.0[0m   drug_a   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m    [3;92mTrue[0m                    
         [1;36m498[0m  cell_line_b    [1;36m10.0[0m   drug_b   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
         [1;36m499[0m  cell_line_b  [1;36m1000.0[0m  control  control  [33m...[0m  [3;91mFalse[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                    
                                                                                                         
         [1m[[0m[1;36m500[0m rows x [1;36m12[0m columns[1m][0m, rep_dict: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m{[0m[32m'control'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.59391007[0m[1m][0m,      
                [1m[[0m [1;36m0.20409122[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.01214352[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.44800279[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.00077153[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-0.93050865[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.38520746[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.41066904[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.99718101[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.93126932[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.11366179[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.71490066[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-1.17020534[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-2.00621602[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.03705156[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-1.88794363[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.88174978[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.65713978[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.64648739[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.64351735[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m, [1m([0m[32m'cell_type'[0m, [1m{[0m[32m'cell_line_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.40729188[0m[1m][0m,                   
                [1m[[0m [1;36m0.89390673[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.00872591[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.33946631[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.38939039[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.12149732[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.16068739[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.68393176[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.23121534[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m[1m][0m[1m)[0m, condition_id_key: [3;35mNone[0m                                              
[34mINFO    [0m self._perturbation_covariates: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m[[0m[32m'drug1'[0m, [32m'drug2'[0m[1m][0m[1m)[0m[1m][0m[1m)[0m                      
[34mINFO    [0m self._sample_covariates: [1m[[0m[1m][0m                                                                     
[34mINFO    [0m self._split_covariates: [1m[[0m[1m][0m                                                                      
[34mINFO    [0m old tgt_idx: [1;36m0[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'control'[0m, [32m'drug2'[0m: [32m'control'[0m[1m}[0m                              
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m0.59391007[0m [1;36m0.20409122[0m [1;36m2.01214352[0m[1m][0m, sum:                 
         [1;36m6.725827115706103[0m                                                                               
[34mINFO    [0m old tgt_idx: [1;36m1[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m2.0468065292154103[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m2[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m0.28279460652485056[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m3[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m-0.09212040732973514[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m4[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m0.28279460652485067[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m5[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.481217316165709[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m6[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m7[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-0.09212040732973548[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m8[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m9[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-2.231047343874881[0m                                                                              
[34mINFO    [0m >old return: split_covariates_mask: [3;35mNone[0m, perturbation_covariates_mask: [3;35mNone[0m                    
[34mINFO    [0m >old return: split_idx_to_covariates: [1m{[0m[1m}[0m, perturbation_idx_to_covariates: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'control'[0m, 
         [32m'control'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m1[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m2[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m,    
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m3[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m4[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m5[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m6[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m7[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m8[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m,     
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m9[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m[1m}[0m                         
[34mINFO    [0m >old return: perturbation_idx_to_id: [1m{[0m[1m}[0m, condition_data: [1m{[0m[32m'drug'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1m[[0m [1;36m0.59391007[0m,         
         [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                                           
                   [1;36m1.00077153[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m0.59391007[0m,  [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                    
                   [1;36m1.00077153[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m[1m][0m[1m)[0m[1m}[0m                                                                       
[34mINFO    [0m >old return: control_to_perturbation: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[1;36m0[0m, [1;36m1[0m, [1;36m2[0m, [1;36m3[0m, [1;36m4[0m, [1;36m5[0m, [1;36m6[0m, [1;36m7[0m, [1;36m8[0m, [1;36m9[0m[1m][0m[1m)[0m[1m}[0m                
pred_data: PredictionData(cell_data=array([[0.54962515, 0.18763018, 0.56914549, ..., 0.38548274, 0.11456399,
        0.13340325],
       [0.32887327, 0.84993855, 0.02231562, ..., 0.62997669, 0.00914254,
        0.69455044],
       [0.81826634, 0.76025063, 0.76612795, ..., 0.48867486, 0.3932288 ,
        0.44532861],
       ...,
       [0.28179957, 0.10919196, 0.97260579, ..., 0.11311244, 0.33657766,
        0.15924755],
       [0.0996858 , 0.04953436, 0.81091584, ..., 0.80573532, 0.53882898,
        0.46909426],
       [0.71618425, 0.9698739 , 0.13739646, ..., 0.51119001, 0.74209687,
        0.5381115 ]], shape=(500, 50)), split_covariates_mask=array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int32), split_idx_to_covariates={}, perturbation_idx_to_covariates={0: array(['control', 'control'], dtype=object), 1: array(['drug_a', 'drug_a'], dtype=object), 2: array(['drug_a', 'drug_b'], dtype=object), 3: array(['drug_a', 'drug_c'], dtype=object), 4: array(['drug_b', 'drug_a'], dtype=object), 5: array(['drug_b', 'drug_b'], dtype=object), 6: array(['drug_b', 'drug_c'], dtype=object), 7: array(['drug_c', 'drug_a'], dtype=object), 8: array(['drug_c', 'drug_b'], dtype=object), 9: array(['drug_c', 'drug_c'], dtype=object)}, perturbation_idx_to_id={}, condition_data={'drug': array([[[ 0.59391007,  0.20409122,  2.01214352, -0.44800279,
          1.00077153],
        [ 0.59391007,  0.20409122,  2.01214352, -0.44800279,
          1.00077153]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [-0.93050865, -0.38520746,  0.41066904,  0.99718101,
          0.93126932]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [ 3.11366179, -0.71490066, -1.17020534, -2.00621602,
          0.03705156]],

       [[-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735],
        [-1.88794363, -0.88174978,  1.65713978, -0.64648739,
          0.64351735]]])}, control_to_perturbation={0: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])}, max_combination_length=2, null_value=0.0, data_manager=<cellflow.data._datamanager.DataManager object at 0x178bcd8d0>)
[34mINFO    [0m  Function args: split_cov_combs: [1m[[0m[1m[[0m[1m][0m[1m][0m, adata: [3;35mNone[0m, covariate_data:       cell_type  dosage     
         drug1    drug2  [33m...[0m drug_a drug_b drug_c control                                                
         [1;36m0[0m   cell_line_c  [1;36m1000.0[0m   drug_a   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m  [3;91mFalse[0m   [3;91mFalse[0m                     
         [1;36m1[0m   cell_line_c  [1;36m1000.0[0m  control  control  [33m...[0m  [3;91mFalse[0m  [3;91mFalse[0m  [3;91mFalse[0m    [3;92mTrue[0m                     
         [1;36m3[0m   cell_line_a   [1;36m100.0[0m   drug_c   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m   [3;91mFalse[0m                     
         [1;36m4[0m   cell_line_b    [1;36m10.0[0m   drug_b   drug_b  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;91mFalse[0m                     
         [1;36m5[0m   cell_line_c   [1;36m100.0[0m   drug_b   drug_a  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;91mFalse[0m                     
         [1;36m6[0m   cell_line_a  [1;36m1000.0[0m   drug_a   drug_c  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m   [3;91mFalse[0m                     
         [1;36m7[0m   cell_line_c  [1;36m1000.0[0m   drug_b   drug_c  [33m...[0m  [3;91mFalse[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;91mFalse[0m                     
         [1;36m9[0m   cell_line_c    [1;36m10.0[0m   drug_a   drug_b  [33m...[0m   [3;92mTrue[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;91mFalse[0m                     
         [1;36m10[0m  cell_line_b   [1;36m100.0[0m   drug_c   drug_a  [33m...[0m   [3;92mTrue[0m  [3;91mFalse[0m   [3;92mTrue[0m   [3;91mFalse[0m                     
         [1;36m23[0m  cell_line_c    [1;36m10.0[0m   drug_c   drug_b  [33m...[0m  [3;91mFalse[0m   [3;92mTrue[0m   [3;92mTrue[0m   [3;91mFalse[0m                     
                                                                                                         
         [1m[[0m[1;36m10[0m rows x [1;36m12[0m columns[1m][0m, rep_dict: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m{[0m[32m'control'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.59391007[0m[1m][0m,       
                [1m[[0m [1;36m0.20409122[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.01214352[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.44800279[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.00077153[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-0.93050865[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.38520746[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.41066904[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.99718101[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.93126932[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.11366179[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.71490066[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-1.17020534[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-2.00621602[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.03705156[0m[1m][0m[1m][0m[1m)[0m, [32m'drug_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1;36m-1.88794363[0m[1m][0m,                                         
                [1m[[0m[1;36m-0.88174978[0m[1m][0m,                                                                           
                [1m[[0m [1;36m1.65713978[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.64648739[0m[1m][0m,                                                                           
                [1m[[0m [1;36m0.64351735[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m, [1m([0m[32m'cell_type'[0m, [1m{[0m[32m'cell_line_a'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.40729188[0m[1m][0m,                   
                [1m[[0m [1;36m0.89390673[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.00872591[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_b'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m3.33946631[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.38939039[0m[1m][0m,                                                                           
                [1m[[0m [1;36m2.12149732[0m[1m][0m[1m][0m[1m)[0m, [32m'cell_line_c'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m [1;36m0.16068739[0m[1m][0m,                                    
                [1m[[0m[1;36m-0.68393176[0m[1m][0m,                                                                           
                [1m[[0m[1;36m-0.23121534[0m[1m][0m[1m][0m[1m)[0m[1m}[0m[1m)[0m[1m][0m[1m)[0m, condition_id_key: [3;35mNone[0m                                              
[34mINFO    [0m self._perturbation_covariates: [1;35mOrderedDict[0m[1m([0m[1m[[0m[1m([0m[32m'drug'[0m, [1m[[0m[32m'drug1'[0m, [32m'drug2'[0m[1m][0m[1m)[0m[1m][0m[1m)[0m                      
[34mINFO    [0m self._sample_covariates: [1m[[0m[1m][0m                                                                     
[34mINFO    [0m self._split_covariates: [1m[[0m[1m][0m                                                                      
[34mINFO    [0m old tgt_idx: [1;36m0[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'control'[0m, [32m'drug2'[0m: [32m'control'[0m[1m}[0m                              
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m0.59391007[0m [1;36m0.20409122[0m [1;36m2.01214352[0m[1m][0m, sum:                 
         [1;36m6.725827115706103[0m                                                                               
[34mINFO    [0m old tgt_idx: [1;36m1[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m2.0468065292154103[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m2[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m0.28279460652485056[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m3[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_a'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-0.93050865[0m [1;36m-0.38520746[0m  [1;36m0.41066904[0m[1m][0m, sum:              
         [1;36m-0.09212040732973514[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m4[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m0.28279460652485067[0m                                                                             
[34mINFO    [0m old tgt_idx: [1;36m5[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.481217316165709[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m6[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_b'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m [1;36m3.11366179[0m [1;36m-0.71490066[0m [1;36m-1.17020534[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m7[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_a'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-0.09212040732973548[0m                                                                            
[34mINFO    [0m old tgt_idx: [1;36m8[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_b'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-1.856132330020295[0m                                                                              
[34mINFO    [0m old tgt_idx: [1;36m9[0m, tgt_cond: [1m{[0m[32m'drug1'[0m: [32m'drug_c'[0m, [32m'drug2'[0m: [32m'drug_c'[0m[1m}[0m                                
[34mINFO    [0m old > drug embedding first few values: [1m[[0m[1;36m-1.88794363[0m [1;36m-0.88174978[0m  [1;36m1.65713978[0m[1m][0m, sum:              
         [1;36m-2.231047343874881[0m                                                                              
[34mINFO    [0m >old return: split_covariates_mask: [3;35mNone[0m, perturbation_covariates_mask: [3;35mNone[0m                    
[34mINFO    [0m >old return: split_idx_to_covariates: [1m{[0m[1m}[0m, perturbation_idx_to_covariates: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'control'[0m, 
         [32m'control'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m1[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m2[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m,    
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m3[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_a'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m4[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m5[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m, [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m6[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_b'[0m,     
         [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m7[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_a'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m8[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m,     
         [32m'drug_b'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m, [1;36m9[0m: [1;35marray[0m[1m([0m[1m[[0m[32m'drug_c'[0m, [32m'drug_c'[0m[1m][0m, [33mdtype[0m=[35mobject[0m[1m)[0m[1m}[0m                         
[34mINFO    [0m >old return: perturbation_idx_to_id: [1m{[0m[1m}[0m, condition_data: [1m{[0m[32m'drug'[0m: [1;35marray[0m[1m([0m[1m[[0m[1m[[0m[1m[[0m [1;36m0.59391007[0m,         
         [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                                           
                   [1;36m1.00077153[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m0.59391007[0m,  [1;36m0.20409122[0m,  [1;36m2.01214352[0m, [1;36m-0.44800279[0m,                                    
                   [1;36m1.00077153[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-0.93050865[0m, [1;36m-0.38520746[0m,  [1;36m0.41066904[0m,  [1;36m0.99718101[0m,                                    
                   [1;36m0.93126932[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m [1;36m3.11366179[0m, [1;36m-0.71490066[0m, [1;36m-1.17020534[0m, [1;36m-2.00621602[0m,                                    
                   [1;36m0.03705156[0m[1m][0m[1m][0m,                                                                         
                                                                                                         
                [1m[[0m[1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m,                                                                          
                 [1m[[0m[1;36m-1.88794363[0m, [1;36m-0.88174978[0m,  [1;36m1.65713978[0m, [1;36m-0.64648739[0m,                                    
                   [1;36m0.64351735[0m[1m][0m[1m][0m[1m][0m[1m)[0m[1m}[0m                                                                       
[34mINFO    [0m >old return: control_to_perturbation: [1m{[0m[1;36m0[0m: [1;35marray[0m[1m([0m[1m[[0m[1;36m0[0m, [1;36m1[0m, [1;36m2[0m, [1;36m3[0m, [1;36m4[0m, [1;36m5[0m, [1;36m6[0m, [1;36m7[0m, [1;36m8[0m, [1;36m9[0m[1m][0m[1m)[0m[1m}[0m                
.

=============================== warnings summary ===============================
../../../mambaforge/envs/cellflow/lib/python3.11/site-packages/jaxopt/__init__.py:59
  /Users/selman.ozleyen/mambaforge/envs/cellflow/lib/python3.11/site-packages/jaxopt/__init__.py:59: DeprecationWarning: JAXopt is no longer maintained. See https://docs.jax.dev/en/latest/ for alternatives.
    warnings.warn(

tests/model/test_cellflow.py::TestCellFlow::test_cellflow_solver[concatenation-0.0-deterministic-otfm]
  /Users/selman.ozleyen/mambaforge/envs/cellflow/lib/python3.11/site-packages/anndata/_core/aligned_df.py:68: ImplicitModificationWarning: Transforming to str index.
    warnings.warn("Transforming to str index.", ImplicitModificationWarning)

tests/model/test_cellflow.py::TestCellFlow::test_cellflow_solver[concatenation-0.0-deterministic-otfm]
tests/model/test_cellflow.py::TestCellFlow::test_cellflow_solver[concatenation-0.0-deterministic-otfm]
tests/model/test_cellflow.py::TestCellFlow::test_cellflow_solver[concatenation-0.0-deterministic-otfm]
tests/model/test_cellflow.py::TestCellFlow::test_cellflow_solver[concatenation-0.0-deterministic-otfm]
  /Users/selman.ozleyen/Documents/projects/cell_flow_perturbation/src/cellflow/data/_datamanager.py:960: SettingWithCopyWarning: 
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    _covariate_data["cell_index"] = _covariate_data.index

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================ 1 passed, 144 deselected, 6 warnings in 36.95s ================
